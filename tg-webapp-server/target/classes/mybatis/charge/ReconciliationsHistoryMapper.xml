<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.plou.web.charge.chargeconfig.dao.ReconciliationsHistoryMapper">
    <resultMap id="BaseResultMap" type="cn.plou.web.charge.chargeconfig.entity.ReconciliationsHistory">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="primary_id" jdbcType="VARCHAR" property="primaryId"/>
        <result column="company_id" jdbcType="VARCHAR" property="companyId"/>
        <result column="reconciliations_date" jdbcType="TIMESTAMP" property="reconciliationsDate"/>
        <result column="reconciliations_user" jdbcType="VARCHAR" property="reconciliationsUser"/>
        <result column="reconciliations_status" jdbcType="VARCHAR" property="reconciliationsStatus"/>
        <result column="annual" jdbcType="VARCHAR" property="annual"/>
        <result column="account_type" jdbcType="VARCHAR" property="accountType"/>
        <result column="account_channel" jdbcType="VARCHAR" property="accountChannel"/>
        <result column="pay_money" jdbcType="DECIMAL" property="payMoney"/>
        <result column="point_money" jdbcType="DECIMAL" property="pointMoney"/>
        <result column="account_explain" jdbcType="VARCHAR" property="accountExplain"/>
        <result column="notes" jdbcType="VARCHAR" property="notes"/>
        <result column="create_date" jdbcType="TIMESTAMP" property="createDate"/>
        <result column="create_user" jdbcType="VARCHAR" property="createUser"/>
        <result column="update_date" jdbcType="TIMESTAMP" property="updateDate"/>
        <result column="update_user" jdbcType="VARCHAR" property="updateUser"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        primary_id, company_id, reconciliations_date, reconciliations_user, reconciliations_status,
        annual, account_type, account_channel, pay_money, point_money, account_explain, notes,
        create_date, create_user, update_date, update_user
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        from reconciliations_history
        where primary_id = #{primaryId,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from reconciliations_history
        where primary_id = #{primaryId,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="cn.plou.web.charge.chargeconfig.entity.ReconciliationsHistory">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into reconciliations_history (primary_id, company_id, reconciliations_date,
        reconciliations_user, reconciliations_status,
        annual, account_type, account_channel,
        pay_money, point_money, account_explain,
        notes, create_date, create_user,
        update_date, update_user)
        values (#{primaryId,jdbcType=VARCHAR}, #{companyId,jdbcType=VARCHAR}, #{reconciliationsDate,jdbcType=TIMESTAMP},
        #{reconciliationsUser,jdbcType=VARCHAR}, #{reconciliationsStatus,jdbcType=VARCHAR},
        #{annual,jdbcType=VARCHAR}, #{accountType,jdbcType=VARCHAR}, #{accountChannel,jdbcType=VARCHAR},
        #{payMoney,jdbcType=DECIMAL}, #{pointMoney,jdbcType=DECIMAL}, #{accountExplain,jdbcType=VARCHAR},
        #{notes,jdbcType=VARCHAR}, #{createDate,jdbcType=TIMESTAMP}, #{createUser,jdbcType=VARCHAR},
        #{updateDate,jdbcType=TIMESTAMP}, #{updateUser,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" parameterType="cn.plou.web.charge.chargeconfig.entity.ReconciliationsHistory">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into reconciliations_history
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="primaryId != null">
                primary_id,
            </if>
            <if test="companyId != null">
                company_id,
            </if>
            <if test="reconciliationsDate != null">
                reconciliations_date,
            </if>
            <if test="reconciliationsUser != null">
                reconciliations_user,
            </if>
            <if test="reconciliationsStatus != null">
                reconciliations_status,
            </if>
            <if test="annual != null">
                annual,
            </if>
            <if test="accountType != null">
                account_type,
            </if>
            <if test="accountChannel != null">
                account_channel,
            </if>
            <if test="payMoney != null">
                pay_money,
            </if>
            <if test="pointMoney != null">
                point_money,
            </if>
            <if test="accountExplain != null">
                account_explain,
            </if>
            <if test="notes != null">
                notes,
            </if>
            <if test="createDate != null">
                create_date,
            </if>
            <if test="createUser != null">
                create_user,
            </if>
            <if test="updateDate != null">
                update_date,
            </if>
            <if test="updateUser != null">
                update_user,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="primaryId != null">
                #{primaryId,jdbcType=VARCHAR},
            </if>
            <if test="companyId != null">
                #{companyId,jdbcType=VARCHAR},
            </if>
            <if test="reconciliationsDate != null">
                #{reconciliationsDate,jdbcType=TIMESTAMP},
            </if>
            <if test="reconciliationsUser != null">
                #{reconciliationsUser,jdbcType=VARCHAR},
            </if>
            <if test="reconciliationsStatus != null">
                #{reconciliationsStatus,jdbcType=VARCHAR},
            </if>
            <if test="annual != null">
                #{annual,jdbcType=VARCHAR},
            </if>
            <if test="accountType != null">
                #{accountType,jdbcType=VARCHAR},
            </if>
            <if test="accountChannel != null">
                #{accountChannel,jdbcType=VARCHAR},
            </if>
            <if test="payMoney != null">
                #{payMoney,jdbcType=DECIMAL},
            </if>
            <if test="pointMoney != null">
                #{pointMoney,jdbcType=DECIMAL},
            </if>
            <if test="accountExplain != null">
                #{accountExplain,jdbcType=VARCHAR},
            </if>
            <if test="notes != null">
                #{notes,jdbcType=VARCHAR},
            </if>
            <if test="createDate != null">
                #{createDate,jdbcType=TIMESTAMP},
            </if>
            <if test="createUser != null">
                #{createUser,jdbcType=VARCHAR},
            </if>
            <if test="updateDate != null">
                #{updateDate,jdbcType=TIMESTAMP},
            </if>
            <if test="updateUser != null">
                #{updateUser,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="cn.plou.web.charge.chargeconfig.entity.ReconciliationsHistory">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update reconciliations_history
        <set>
            <if test="companyId != null">
                company_id = #{companyId,jdbcType=VARCHAR},
            </if>
            <if test="reconciliationsDate != null">
                reconciliations_date = #{reconciliationsDate,jdbcType=TIMESTAMP},
            </if>
            <if test="reconciliationsUser != null">
                reconciliations_user = #{reconciliationsUser,jdbcType=VARCHAR},
            </if>
            <if test="reconciliationsStatus != null">
                reconciliations_status = #{reconciliationsStatus,jdbcType=VARCHAR},
            </if>
            <if test="annual != null">
                annual = #{annual,jdbcType=VARCHAR},
            </if>
            <if test="accountType != null">
                account_type = #{accountType,jdbcType=VARCHAR},
            </if>
            <if test="accountChannel != null">
                account_channel = #{accountChannel,jdbcType=VARCHAR},
            </if>
            <if test="payMoney != null">
                pay_money = #{payMoney,jdbcType=DECIMAL},
            </if>
            <if test="pointMoney != null">
                point_money = #{pointMoney,jdbcType=DECIMAL},
            </if>
            <if test="accountExplain != null">
                account_explain = #{accountExplain,jdbcType=VARCHAR},
            </if>
            <if test="notes != null">
                notes = #{notes,jdbcType=VARCHAR},
            </if>
            <if test="createDate != null">
                create_date = #{createDate,jdbcType=TIMESTAMP},
            </if>
            <if test="createUser != null">
                create_user = #{createUser,jdbcType=VARCHAR},
            </if>
            <if test="updateDate != null">
                update_date = #{updateDate,jdbcType=TIMESTAMP},
            </if>
            <if test="updateUser != null">
                update_user = #{updateUser,jdbcType=VARCHAR},
            </if>
        </set>
        where primary_id = #{primaryId,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="cn.plou.web.charge.chargeconfig.entity.ReconciliationsHistory">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update reconciliations_history
        set company_id = #{companyId,jdbcType=VARCHAR},
        reconciliations_date = #{reconciliationsDate,jdbcType=TIMESTAMP},
        reconciliations_user = #{reconciliationsUser,jdbcType=VARCHAR},
        reconciliations_status = #{reconciliationsStatus,jdbcType=VARCHAR},
        annual = #{annual,jdbcType=VARCHAR},
        account_type = #{accountType,jdbcType=VARCHAR},
        account_channel = #{accountChannel,jdbcType=VARCHAR},
        pay_money = #{payMoney,jdbcType=DECIMAL},
        point_money = #{pointMoney,jdbcType=DECIMAL},
        account_explain = #{accountExplain,jdbcType=VARCHAR},
        notes = #{notes,jdbcType=VARCHAR},
        create_date = #{createDate,jdbcType=TIMESTAMP},
        create_user = #{createUser,jdbcType=VARCHAR},
        update_date = #{updateDate,jdbcType=TIMESTAMP},
        update_user = #{updateUser,jdbcType=VARCHAR}
        where primary_id = #{primaryId,jdbcType=VARCHAR}
    </update>

    <select id="getListBySearch" parameterType="cn.plou.web.charge.chargeconfig.dto.AccountHistoryDTO" resultType="cn.plou.web.charge.chargeconfig.vo.AccountHistoryListVO">
        select
        primary_id,
        company_id,
        reconciliations_date,
        reconciliations_user,
        u.username as reconciliationsUserName,
        reconciliations_status,
        t1.type_name as reconciliationsStatusName,
        annual,
        account_type,
        t2.type_name as accountTypeName,
        account_channel,
        t3.type_name as accountChannelName,
        pay_money,
        point_money,
        account_explain,
        h.notes,
        h.create_date,
        h.create_user,
        h.update_date,
        h.update_user
        from reconciliations_history h
        left join type_mst t1 on t1.id = h.reconciliations_status
        left join type_mst t2 on t2.id = h.account_type
        left join type_mst t3 on t3.id = h.account_channel
        left join user_login u on u.user_code = h.reconciliations_user
        where
        h.company_id = #{companyId,jdbcType=VARCHAR}
        <if test="reconciliationsDateStart != null">and DATE_FORMAT(h.reconciliations_date,'%Y-%m-%d') &gt;= DATE_FORMAT(#{reconciliationsDateStart,jdbcType=TIMESTAMP},'%Y-%m-%d')</if>
        <if test="reconciliationsDateEnd != null">and DATE_FORMAT(h.reconciliations_date,'%Y-%m-%d') &lt;= DATE_FORMAT(#{reconciliationsDateEnd,jdbcType=TIMESTAMP},'%Y-%m-%d')</if>
        <if test="reconciliationsStatus != null and reconciliationsStatus != ''">and h.reconciliations_status = #{reconciliationsStatus,jdbcType=VARCHAR}</if>
        <if test="accountChannel != null and accountChannel != ''">and h.account_channel = #{accountChannel,jdbcType=VARCHAR}</if>
        <if test="reconciliationsUser != null and reconciliationsUser != ''">and h.reconciliations_user = #{reconciliationsUser,jdbcType=VARCHAR}</if>
        <if test="sortby != null and sortby != ''">
            order by h.${sortby}
        </if>
        <if test="order != null and order != ''">
            ${order}
        </if>
        <if test="start != null and pageSize != null">
            limit ${start},${pageSize}
        </if>
    </select>

    <select id="getListCountBySearch" parameterType="cn.plou.web.charge.chargeconfig.dto.AccountHistoryDTO" resultType="java.lang.Integer">
        select count(*)
        from reconciliations_history h
        where
        h.company_id = #{companyId,jdbcType=VARCHAR}
        <if test="reconciliationsDateStart != null">and DATE_FORMAT(h.reconciliations_date,'%Y-%m-%d') &gt;= DATE_FORMAT(#{reconciliationsDateStart,jdbcType=TIMESTAMP},'%Y-%m-%d')</if>
        <if test="reconciliationsDateEnd != null">and DATE_FORMAT(h.reconciliations_date,'%Y-%m-%d') &lt;= DATE_FORMAT(#{reconciliationsDateEnd,jdbcType=TIMESTAMP},'%Y-%m-%d')</if>
        <if test="reconciliationsStatus != null and reconciliationsStatus != ''">and h.reconciliations_status = #{reconciliationsStatus,jdbcType=VARCHAR}</if>
        <if test="accountChannel != null and accountChannel != ''">and h.account_channel = #{accountChannel,jdbcType=VARCHAR}</if>
        <if test="reconciliationsUser != null and reconciliationsUser != ''">and h.reconciliations_user = #{reconciliationsUser,jdbcType=VARCHAR}</if>
    </select>

    <select id="getDetail" parameterType="cn.plou.web.charge.chargeconfig.dto.ChargeAccountDTO" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from reconciliations_history
        where company_id = #{companyId,jdbcType=VARCHAR}
        and DATE_FORMAT(reconciliations_date,'%Y-%m-%d') = DATE_FORMAT(#{accountTime,jdbcType=TIMESTAMP},'%Y-%m-%d')
        and account_channel = #{payChannel,jdbcType=VARCHAR}
    </select>
</mapper>