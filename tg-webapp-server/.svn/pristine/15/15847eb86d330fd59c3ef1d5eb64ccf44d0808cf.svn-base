<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.plou.web.charge.heatingmanage.dao.HouseHeatDetailMapper">
    <resultMap id="BaseResultMap" type="cn.plou.web.charge.heatingmanage.domain.HouseHeatDetail">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="primary_id" jdbcType="VARCHAR" property="primaryId"/>
        <result column="consumer_id" jdbcType="VARCHAR" property="consumerId"/>
        <result column="meter_id" jdbcType="VARCHAR" property="meterId"/>
        <result column="company_id" jdbcType="VARCHAR" property="companyId"/>
        <result column="annual" jdbcType="VARCHAR" property="annual"/>
        <result column="meter_start" jdbcType="DECIMAL" property="meterStart"/>
        <result column="start_time" jdbcType="DATE" property="startTime"/>
        <result column="meter_start_conf" jdbcType="DECIMAL" property="meterStartConf"/>
        <result column="meter_end" jdbcType="DECIMAL" property="meterEnd"/>
        <result column="end_time" jdbcType="DATE" property="endTime"/>
        <result column="meter_end_conf" jdbcType="DECIMAL" property="meterEndConf"/>
        <result column="adj_desc" jdbcType="VARCHAR" property="adjDesc"/>
        <result column="meter_read" jdbcType="DECIMAL" property="meterRead"/>
        <result column="heat_adj" jdbcType="DECIMAL" property="heatAdj"/>
        <result column="heat_adj_desc" jdbcType="VARCHAR" property="heatAdjDesc"/>
        <result column="meter_adjust_sum" jdbcType="DECIMAL" property="meterAdjustSum"/>
        <result column="memo1" jdbcType="VARCHAR" property="memo1"/>
        <result column="memo2" jdbcType="VARCHAR" property="memo2"/>
        <result column="create_date" jdbcType="DATE" property="createDate"/>
        <result column="create_user" jdbcType="VARCHAR" property="createUser"/>
        <result column="update_date" jdbcType="DATE" property="updateDate"/>
        <result column="update_user" jdbcType="VARCHAR" property="updateUser"/>
        <result column="address" jdbcType="VARCHAR" property="address"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        primary_id, consumer_id, meter_id, company_id, annual, meter_start, start_time, meter_start_conf,
        meter_end, end_time, meter_end_conf, adj_desc, meter_read, heat_adj, heat_adj_desc,
        meter_adjust_sum, memo1, memo2, create_date, create_user, update_date, update_user
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        from house_heat_detail
        where primary_id = #{primaryId,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from house_heat_detail
        where primary_id = #{primaryId,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="cn.plou.web.charge.heatingmanage.domain.HouseHeatDetail">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into house_heat_detail (primary_id, consumer_id, meter_id,
        company_id, annual, meter_start,
        start_time, meter_start_conf, meter_end,
        end_time, meter_end_conf, adj_desc,
        meter_read, heat_adj, heat_adj_desc,
        meter_adjust_sum, memo1, memo2,
        create_date, create_user, update_date,
        update_user)
        values (#{primaryId,jdbcType=VARCHAR}, #{consumerId,jdbcType=VARCHAR}, #{meterId,jdbcType=VARCHAR},
        #{companyId,jdbcType=VARCHAR}, #{annual,jdbcType=VARCHAR}, #{meterStart,jdbcType=DECIMAL},
        #{startTime,jdbcType=DATE}, #{meterStartConf,jdbcType=DECIMAL}, #{meterEnd,jdbcType=DECIMAL},
        #{endTime,jdbcType=DATE}, #{meterEndConf,jdbcType=DECIMAL}, #{adjDesc,jdbcType=VARCHAR},
        #{meterRead,jdbcType=DECIMAL}, #{heatAdj,jdbcType=DECIMAL}, #{heatAdjDesc,jdbcType=VARCHAR},
        #{meterAdjustSum,jdbcType=DECIMAL}, #{memo1,jdbcType=VARCHAR}, #{memo2,jdbcType=VARCHAR},
        #{createDate,jdbcType=DATE}, #{createUser,jdbcType=VARCHAR}, #{updateDate,jdbcType=DATE},
        #{updateUser,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" parameterType="cn.plou.web.charge.heatingmanage.domain.HouseHeatDetail">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into house_heat_detail
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="primaryId != null">
                primary_id,
            </if>
            <if test="consumerId != null">
                consumer_id,
            </if>
            <if test="meterId != null">
                meter_id,
            </if>
            <if test="companyId != null">
                company_id,
            </if>
            <if test="annual != null">
                annual,
            </if>
            <if test="meterStart != null">
                meter_start,
            </if>
            <if test="startTime != null">
                start_time,
            </if>
            <if test="meterStartConf != null">
                meter_start_conf,
            </if>
            <if test="meterEnd != null">
                meter_end,
            </if>
            <if test="endTime != null">
                end_time,
            </if>
            <if test="meterEndConf != null">
                meter_end_conf,
            </if>
            <if test="adjDesc != null">
                adj_desc,
            </if>
            <if test="meterRead != null">
                meter_read,
            </if>
            <if test="heatAdj != null">
                heat_adj,
            </if>
            <if test="heatAdjDesc != null">
                heat_adj_desc,
            </if>
            <if test="meterAdjustSum != null">
                meter_adjust_sum,
            </if>
            <if test="memo1 != null">
                memo1,
            </if>
            <if test="memo2 != null">
                memo2,
            </if>
            <if test="createDate != null">
                create_date,
            </if>
            <if test="createUser != null">
                create_user,
            </if>
            <if test="updateDate != null">
                update_date,
            </if>
            <if test="updateUser != null">
                update_user,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="primaryId != null">
                #{primaryId,jdbcType=VARCHAR},
            </if>
            <if test="consumerId != null">
                #{consumerId,jdbcType=VARCHAR},
            </if>
            <if test="meterId != null">
                #{meterId,jdbcType=VARCHAR},
            </if>
            <if test="companyId != null">
                #{companyId,jdbcType=VARCHAR},
            </if>
            <if test="annual != null">
                #{annual,jdbcType=VARCHAR},
            </if>
            <if test="meterStart != null">
                #{meterStart,jdbcType=DECIMAL},
            </if>
            <if test="startTime != null">
                #{startTime,jdbcType=DATE},
            </if>
            <if test="meterStartConf != null">
                #{meterStartConf,jdbcType=DECIMAL},
            </if>
            <if test="meterEnd != null">
                #{meterEnd,jdbcType=DECIMAL},
            </if>
            <if test="endTime != null">
                #{endTime,jdbcType=DATE},
            </if>
            <if test="meterEndConf != null">
                #{meterEndConf,jdbcType=DECIMAL},
            </if>
            <if test="adjDesc != null">
                #{adjDesc,jdbcType=VARCHAR},
            </if>
            <if test="meterRead != null">
                #{meterRead,jdbcType=DECIMAL},
            </if>
            <if test="heatAdj != null">
                #{heatAdj,jdbcType=DECIMAL},
            </if>
            <if test="heatAdjDesc != null">
                #{heatAdjDesc,jdbcType=VARCHAR},
            </if>
            <if test="meterAdjustSum != null">
                #{meterAdjustSum,jdbcType=DECIMAL},
            </if>
            <if test="memo1 != null">
                #{memo1,jdbcType=VARCHAR},
            </if>
            <if test="memo2 != null">
                #{memo2,jdbcType=VARCHAR},
            </if>
            <if test="createDate != null">
                #{createDate,jdbcType=DATE},
            </if>
            <if test="createUser != null">
                #{createUser,jdbcType=VARCHAR},
            </if>
            <if test="updateDate != null">
                #{updateDate,jdbcType=DATE},
            </if>
            <if test="updateUser != null">
                #{updateUser,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="cn.plou.web.charge.heatingmanage.domain.HouseHeatDetail">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update house_heat_detail
        <set>
            <if test="consumerId != null">
                consumer_id = #{consumerId,jdbcType=VARCHAR},
            </if>
            <if test="meterId != null">
                meter_id = #{meterId,jdbcType=VARCHAR},
            </if>
            <if test="companyId != null">
                company_id = #{companyId,jdbcType=VARCHAR},
            </if>
            <if test="annual != null">
                annual = #{annual,jdbcType=VARCHAR},
            </if>
            <if test="meterStart != null">
                meter_start = #{meterStart,jdbcType=DECIMAL},
            </if>
            <if test="startTime != null">
                start_time = #{startTime,jdbcType=DATE},
            </if>
            <if test="meterStartConf != null">
                meter_start_conf = #{meterStartConf,jdbcType=DECIMAL},
            </if>
            <if test="meterEnd != null">
                meter_end = #{meterEnd,jdbcType=DECIMAL},
            </if>
            <if test="endTime != null">
                end_time = #{endTime,jdbcType=DATE},
            </if>
            <if test="meterEndConf != null">
                meter_end_conf = #{meterEndConf,jdbcType=DECIMAL},
            </if>
            <if test="adjDesc != null">
                adj_desc = #{adjDesc,jdbcType=VARCHAR},
            </if>
            <if test="meterRead != null">
                meter_read = #{meterRead,jdbcType=DECIMAL},
            </if>
            <if test="heatAdj != null">
                heat_adj = #{heatAdj,jdbcType=DECIMAL},
            </if>
            <if test="heatAdjDesc != null">
                heat_adj_desc = #{heatAdjDesc,jdbcType=VARCHAR},
            </if>
            <if test="meterAdjustSum != null">
                meter_adjust_sum = #{meterAdjustSum,jdbcType=DECIMAL},
            </if>
            <if test="memo1 != null">
                memo1 = #{memo1,jdbcType=VARCHAR},
            </if>
            <if test="memo2 != null">
                memo2 = #{memo2,jdbcType=VARCHAR},
            </if>
            <if test="createDate != null">
                create_date = #{createDate,jdbcType=DATE},
            </if>
            <if test="createUser != null">
                create_user = #{createUser,jdbcType=VARCHAR},
            </if>
            <if test="updateDate != null">
                update_date = #{updateDate,jdbcType=DATE},
            </if>
            <if test="updateUser != null">
                update_user = #{updateUser,jdbcType=VARCHAR},
            </if>
        </set>
        where primary_id = #{primaryId,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="cn.plou.web.charge.heatingmanage.domain.HouseHeatDetail">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update house_heat_detail
        set consumer_id = #{consumerId,jdbcType=VARCHAR},
        meter_id = #{meterId,jdbcType=VARCHAR},
        company_id = #{companyId,jdbcType=VARCHAR},
        annual = #{annual,jdbcType=VARCHAR},
        meter_start = #{meterStart,jdbcType=DECIMAL},
        start_time = #{startTime,jdbcType=DATE},
        meter_start_conf = #{meterStartConf,jdbcType=DECIMAL},
        meter_end = #{meterEnd,jdbcType=DECIMAL},
        end_time = #{endTime,jdbcType=DATE},
        meter_end_conf = #{meterEndConf,jdbcType=DECIMAL},
        adj_desc = #{adjDesc,jdbcType=VARCHAR},
        meter_read = #{meterRead,jdbcType=DECIMAL},
        heat_adj = #{heatAdj,jdbcType=DECIMAL},
        heat_adj_desc = #{heatAdjDesc,jdbcType=VARCHAR},
        meter_adjust_sum = #{meterAdjustSum,jdbcType=DECIMAL},
        memo1 = #{memo1,jdbcType=VARCHAR},
        memo2 = #{memo2,jdbcType=VARCHAR},
        create_date = #{createDate,jdbcType=DATE},
        create_user = #{createUser,jdbcType=VARCHAR},
        update_date = #{updateDate,jdbcType=DATE},
        update_user = #{updateUser,jdbcType=VARCHAR}
        where primary_id = #{primaryId,jdbcType=VARCHAR}
    </update>


    <select id="findByUser" resultType="cn.plou.web.charge.heatingmanage.domain.HouseHeatDetail">
        select
        <include refid="Base_Column_List" />
        from house_heat_detail
        where 1=1
        <if test="consumerId !=null  and consumerId != '' ">
            and consumer_id = #{consumerId}
        </if>
        <if test="annual !=null  and annual != '' ">
            and annual = #{annual}
        </if>
        <if test="sortby!=null">
            order by ${sortby}
        </if>
        <if test="order!=null">
            ${order}
        </if>
    </select>

    <select id="find" resultMap="BaseResultMap">
        select detail.*,info.address,info.name
        from house_heat_detail as detail

        left JOIN houses_info as info on detail.consumer_id =info.consumer_id
        where detail.consumer_id like  concat(#{id},'%')

        <if test="keyWord != null  and  keyWord != ''">
            and (  info.charge_id LIKE concat('%', #{keyWord}, '%')
            or info.tel LIKE concat('%', #{keyWord}, '%')
            or info.idcard LIKE concat('%', #{keyWord}, '%')
            or info.name LIKE concat('%', #{keyWord}, '%')
            )
        </if>

        <if test="annual != null   and  annual != ''">
            and  detail.annual =#{annual}
        </if>
        <if test="sortby != null   and  sortby != ''">
            order by ${sortby}
        </if>

        <if test="order != null  and  order != ''">
            ${order}
        </if>

    </select>


    <select id="getSumMeterRead"  resultType="java.math.BigDecimal">
        select sum(meter_read)
        from house_heat_detail
        where  consumer_id = #{consumerId,jdbcType=VARCHAR} and annual =  #{annual,jdbcType=VARCHAR}
    </select>


    <select id="getSumHeatAdj"  resultType="java.math.BigDecimal">
        select sum(heat_adj)
        from house_heat_detail
        where  consumer_id = #{consumerId,jdbcType=VARCHAR} and annual =  #{annual,jdbcType=VARCHAR}
    </select>
    <!-- ————————————————————————————————cache配置————————————————————————————  -->
    <cache eviction="FIFO" flushInterval="60000" size="1024"  readOnly="true"/>
</mapper>